{% extends 'base.html.twig' %}
{% block title %}Modifier mes informations | Aura{% endblock %}

{% block styles %}
    <style>
        .page-container{max-width:1100px;margin:24px auto;padding:0 16px}
        .page-title{margin:0 0 16px}
        .section{background:#fff;border:1px solid #eee;border-radius:16px;padding:16px;margin-bottom:16px}

        .flash{padding:10px 12px;border-radius:10px;margin:10px 0}
        .flash.success{background:#e6f4ea;color:#146c43}
        .flash.error{background:#fde2e1;color:#a12622}
        .flash.info{background:#eef0f2;color:#333}

        /* Layout formulaire */
        .edit-grid{display:grid;grid-template-columns:180px 1fr;gap:20px;align-items:start;max-width:720px}
        .avatar-box{display:flex;flex-direction:column;gap:10px}
        .avatar{width:160px;height:160px;border-radius:50%;object-fit:cover;border:1px solid #e5e7eb;background:#f3f4f6}

        .field{display:flex;flex-direction:column;gap:6px}
        .field input[type="text"],
        .field input[type="file"]{padding:10px 12px;border:1px solid #ddd;border-radius:8px;font-size:15px;background:#fff}

        .hint{color:#666;font-size:.9rem}
        .actions{margin-top:12px;display:flex;gap:10px;flex-wrap:wrap}

        .btn{display:inline-flex;align-items:center;justify-content:center;border-radius:10px;padding:10px 14px;
            font-weight:700;border:1px solid #000;background:#000;color:#fff;cursor:pointer;text-decoration:none}
        .btn.muted{background:#f1f3f5;border-color:#e9ecef;color:#111}

        @media (max-width:720px){
            .edit-grid{grid-template-columns:1fr}
            .avatar{width:120px;height:120px}
        }
        @media (max-width:640px){
            .page-container{margin:16px auto;padding:0 12px}
            .section{padding:12px;margin-bottom:12px}
        }
    </style>
{% endblock %}

{% block body %}
    <div class="page-container">

        {# Flashes #}
        {% for label, messages in app.flashes %}
            {% for message in messages %}
                <div class="flash {{ label == 'success' ? 'success' : (label == 'error' ? 'error' : 'info') }}">{{ message }}</div>
            {% endfor %}
        {% endfor %}

        <h1 class="page-title">Modifier mes informations</h1>

        <div class="section">
            {{ form_start(form, { attr: { class: 'edit-grid' } }) }}

            {# Colonne avatar #}
            <div class="avatar-box">
                <img
                    src="{{ user.avatarUrl ? asset(user.avatarUrl) : asset('images/avatar-silhouette.png') }}"
                    alt="Photo de profil"
                    class="avatar"
                >
                <div class="field">
                    {{ form_label(form.avatarFile, 'Photo de profil') }}
                    {{ form_widget(form.avatarFile, { attr: { accept: 'image/png,image/jpeg,image/webp' } }) }}
                    <div class="hint">PNG, JPG, WEBP â€” 3&nbsp;Mo max</div>
                    {{ form_errors(form.avatarFile) }}
                </div>
            </div>

            {# Colonne champs #}
            <div>
                <div class="field">
                    {{ form_label(form.username, 'Pseudonyme') }}
                    {{ form_widget(form.username) }}
                    {{ form_errors(form.username) }}
                </div>

                <div class="actions">
                    <button type="submit" class="btn">Enregistrer</button>
                </div>
            </div>

            {{ form_end(form) }}
        </div>

    </div>
{% endblock %}
